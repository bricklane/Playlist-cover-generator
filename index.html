<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generative Art with Tuber Shape Packing</title>
<style>
  #artCanvas {
    width: 300px;
    height: 300px;
    display: block;
    background-color: #013220; /* Dark green background */
  }
  .button {
    padding: 10px;
    margin: 5px;
    cursor: pointer;
  }
</style>
</head>
<body>
<canvas id="artCanvas" width="300" height="300"></canvas>
<button class="button" onclick="createTuberShapePacking()">Create</button>
<button class="button" onclick="savePattern()">Save</button>

<script>
function createTuberShape(ctx, centerX, centerY, maxRadius) {
  var sides = Math.floor(Math.random() * (12 - 8 + 1)) + 8;
  ctx.beginPath();
  var startAngle = Math.random() * Math.PI * 2;
  var angleIncrement = (2 * Math.PI) / sides;
  for (var i = 0; i < sides; i++) {
    var angle = startAngle + i * angleIncrement;
    var sideLength = maxRadius * (0.8 + Math.random() * 0.4); // Side length 80%-120% of maxRadius
    var x = centerX + sideLength * Math.cos(angle);
    var y = centerY + sideLength * Math.sin(angle);
    ctx.lineTo(x, y);
  }
  ctx.closePath();
  ctx.fillStyle = '#8B4513'; // Dark orange color
  ctx.fill();
}

// A simple check to see if a point is inside an already drawn shape
// This function needs more complexity for a robust solution
function isInShape(shapes, x, y, minDist) {
  return shapes.some(shape => {
    var dx = shape.centerX - x;
    var dy = shape.centerY - y;
    var distance = Math.sqrt(dx * dx + dy * dy);
    return distance < (shape.maxRadius + minDist);
  });
}

function createTuberShapePacking() {
  var canvas = document.getElementById('artCanvas');
  var ctx = canvas.getContext('2d');
  var width = canvas.width;
  var height = canvas.height;
  ctx.clearRect(0, 0, width, height);
  ctx.fillStyle = '#013220'; // Dark green
  ctx.fillRect(0, 0, width, height);

  var shapes = [];
  var attempts = 50; // Limit attempts to avoid infinite loops
  var minDist = 10; // Minimum distance between shapes

  while (shapes.length < 10 && attempts > 0) { // Target number of shapes
    var maxRadius = Math.random() * 20 + 10; // Random max radius between 10 and 30
    var centerX = Math.random() * (width - 2 * maxRadius) + maxRadius;
    var centerY = Math.random() * (height - 2 * maxRadius) + maxRadius;

    if (!isInShape(shapes, centerX, centerY, minDist)) {
      createTuberShape(ctx, centerX, centerY, maxRadius);
      shapes.push({ centerX, centerY, maxRadius });
    } else {
      attempts--;
    }
  }
}

function savePattern() {
  var canvas = document.getElementById('artCanvas');
  var dataURL = canvas.toDataURL('image/png');
  var downloadLink = document.createElement('a');
  downloadLink.href = dataURL;
  downloadLink.download = 'tuber-shape-packing.png';
  document.body.appendChild(downloadLink);
  downloadLink.click();
  document.body.removeChild(downloadLink);
}
</script>
</body>
</html>
